function soundOut = singleTapDelay(soundIn, depth, delayTime, feedbackGain)
%delay time given in mSec
delaySamples = floor(44.1*delayTime);

if(feedbackGain == 0 || depth == 0)
    sound1 = [soundIn, zeros(1,delaySamples)];
    sound2 = [zeros(1,delaySamples), soundIn];
    soundOut = sound1 + depth*sound2;

elseif(feedbackGain > 0)
    soundOut = zeros(1, length(soundIn) * 10);
    delayBuffer = soundOut;
    soundOut(1:delaySamples) = soundIn(1:delaySamples);
    delayBuffer(1:delaySamples) = soundIn(1:delaySamples);
    
    for count = (delaySamples + 1):(length(soundOut))
        if(count <= length(soundIn))
            delayBuffer(count) = soundIn(count)
        delayBuffer(count) = soundIn(count) + feedbackGain * delayBuffer(count - delaySamples);
        soundOut(delay
    end
    
    count = delaySamples + 1;
    
    
    
    delayBuffer = soundIn(1:delaySamples);
    count = count + delaySamples;
    while (count < length(soundIn)*5)
        for i = 1:delaySamples
            if(count + i < length(soundIn))
                soundOut(count+i) = soundIn(count+i) + depth*delayBuffer(i);
                delayBuffer(i) = soundIn(count + i);
            else
                soundOut(count+i) = depth*delayBuffer(i);
                delayBuffer(i) = 0;
            end    
        end 
        count = count + delaySamples;
    end    
end    

end

